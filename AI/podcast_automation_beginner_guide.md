# 🧭 자동 팟캐스트 서버 구축 기초 가이드

이 문서는 **비개발자**가 직접 “유튜브 → 팟캐스트 자동 배포 서버”를 구축할 수 있도록 기초 지식과 과정을 단계별로 정리한 가이드입니다.  
모든 과정은 **Docker(도커)** 환경에서 이루어지며, Apple Podcasts 및 Spotify에 RSS를 자동 배포하는 것을 목표로 합니다.

---

## 1️⃣ 개념 이해하기

### 🎯 목표
- 유튜브 영상을 자동으로 **오디오(mp3)** 로 변환하고  
  → **Castopod 서버**로 업로드하여  
  → Apple Podcasts / Spotify에 자동 배포한다.

### 🔍 주요 구성요소
| 구성요소 | 역할 | 쉬운 비유 |
|-----------|-------|------------|
| **Castopod** | 팟캐스트 방송국 서버 (RSS 자동 발행) | 라디오 방송국 |
| **Scheduler** | 정해진 시간에 유튜브 새 영상 확인 | 알람시계 |
| **Downloader/Converter** | 영상에서 오디오(mp3) 추출 | 소리 추출기 |
| **Uploader** | Castopod에 새 에피소드 등록 | 배달원 |
| **Dashboard** | 작업 모니터링 및 제어 화면 | 조종석 |
| **Docker** | 모든 프로그램을 한 박스로 묶어 실행 | 통조림 공장 |

---

## 2️⃣ 도커(Docker)란 무엇인가?

도커는 **여러 프로그램을 한 번에 묶어 실행할 수 있는 환경**입니다.  
각각의 기능(예: Castopod, DB, 다운로더)을 **컨테이너(container)** 라는 작은 상자에 넣고,  
이 상자들을 동시에 작동시키는 구조라고 보면 됩니다.

🧱 예를 들어:
- Castopod: 팟캐스트 방송국 상자
- DB: 저장소 상자
- Downloader: 유튜브에서 오디오 추출 상자
- Scheduler: 알람시계 상자
- Dashboard: 관리용 상자

이 모든 상자를 **도커가 자동으로 조립하고 관리**해 줍니다.

---

## 3️⃣ 사전 준비 (기초 세팅)

### ✅ 필수 설치
1. **Docker Desktop 설치**
   - Windows / Mac 지원  
   - https://www.docker.com/products/docker-desktop/

2. **도메인 이름 (선택사항)**
   - 외부에서 접근하려면 필요 (예: pod.mydomain.com)
   - 실험 단계에서는 `localhost` 로 충분

3. **기본 폴더 구조**
```
podcast-server/
 ├─ compose.yml         # 도커 설정파일
 ├─ .env                # 환경 변수
 ├─ data/
 │   ├─ db/             # 데이터베이스 저장
 │   ├─ media/          # 오디오, 이미지 저장
 │   └─ backups/        # 백업 저장소
 └─ traefik/            # SSL 인증서 저장
```

---

## 4️⃣ Castopod 서버 실행

### ⚙️ 절차
1. 준비된 `compose.yml` 파일을 이용해 Castopod, DB, 프록시(SSL) 실행
2. 터미널에서 다음 명령어 입력  
   ```bash
   docker compose up -d
   ```
3. 브라우저에서 접속  
   - 로컬: `https://localhost`  
   - 도메인 사용 시: `https://pod.mydomain.com`
4. 관리자 계정 생성 → 첫 번째 채널(쇼) 만들기

### ✅ 확인할 점
- 관리자 페이지에서 mp3 파일을 수동으로 올려보세요.  
- 자동으로 **RSS 피드 주소**가 만들어집니다.  
- 이 주소를 Apple Podcasts 또는 Spotify에 제출하면 자동 반영됩니다.

---

## 5️⃣ 유튜브 → 오디오 변환 테스트

### 🎞️ 핵심 개념
1. **유튜브 영상 다운로드**
2. **소리만 추출(mp3 변환)**
3. **Castopod에 수동 업로드 (테스트)**

### 🧰 사용 도구
- **yt-dlp**: 유튜브 영상 다운로드 도구
- **ffmpeg**: 오디오 변환 도구

```bash
yt-dlp -x --audio-format mp3 https://youtube.com/watch?v=영상ID
```

변환된 mp3를 Castopod에 업로드해, RSS 반영 여부를 확인합니다.

---

## 6️⃣ 자동화 구조 (스케줄러와 파이프라인)

자동화는 여러 단계를 **자동으로 연결**한 흐름입니다.

### 🔁 처리 순서
1. **스케줄러**: 매일/매주 정해진 시간에 새 영상을 확인  
2. **다운로더**: 영상에서 소리만 추출  
3. **변환기**: mp3 포맷으로 맞춤  
4. **정보추출기**: 제목·설명·썸네일 등 정보 생성  
5. **업로더**: Castopod에 새 에피소드 등록  
6. **Castopod**: RSS 자동 업데이트 → Apple/Spotify 반영

### 🧩 각 단계의 역할
| 이름 | 기능 | 설명 |
|------|------|------|
| **yt-watcher** | 새 영상 감시 | 유튜브 API로 새 영상 탐색 |
| **router** | 채널 자동 분류 | 제목·플레이리스트 규칙 기반 |
| **downloader** | 영상 다운로드 | yt-dlp로 영상 다운로드 |
| **transcoder** | 오디오 변환 | ffmpeg으로 품질 표준화 |
| **metadata-builder** | 설명 분석 | 타임스탬프 → 챕터 변환 |
| **uploader** | Castopod 업로드 | 자동 에피소드 생성 |

---

## 7️⃣ 대시보드 구성 (비개발자용 화면)

### 🖥️ 주요 탭 구성
| 탭 이름 | 역할 |
|----------|------|
| **홈** | 채널별 현황, RSS 링크 복사, 저장소 용량 표시 |
| **유튜브 소스 관리** | 감시할 플레이리스트/채널 등록, 스케줄 설정 |
| **라우팅 규칙** | 제목 패턴에 따라 자동 분류 |
| **작업 로그** | 어떤 영상이 변환/업로드됐는지 기록 |
| **저장소 관리** | SSD → NAS → S3 저장소 전환 |
| **백업/복원** | 클릭 한 번으로 백업/되돌리기 |
| **통계** | 다운로드 수, 인기 에피소드 확인 |

---

## 8️⃣ 저장소 이해하기

| 저장소 유형 | 설명 | 특징 |
|--------------|------|------|
| **SSD (기본)** | 내 컴퓨터의 저장공간 | 빠르고 간단 |
| **NAS** | 집/회사 내 네트워크 드라이브 | 대용량, 로컬 접근 |
| **S3 / 클라우드** | 인터넷 저장소 | 안정적, 원격 백업 가능 |

전환 시 도커 설정의 경로만 수정하면 됩니다.

---

## 9️⃣ 백업 및 복원

- **DB 백업**: 하루 1회 자동 저장 (예: 새벽 3시)  
- **오디오 백업**: 주 1회 증분 백업  
- **복원**: 클릭 한 번으로 “어제 상태로 되돌리기”  
- **알림**: 오류 시 이메일/메신저 자동 알림

---

## 🔟 진행 로드맵 (초보자용)

| 주차 | 목표 | 세부 내용 |
|------|------|-----------|
| **1주차** | 환경 구축 | Docker 설치, Castopod 실행 |
| **2주차** | 수동 발행 | mp3 업로드 → RSS 확인 |
| **3주차** | 오디오 변환 | yt-dlp, ffmpeg 실습 |
| **4주차** | 자동화 구성 | 스케줄러, 파이프라인, 대시보드 구상 |

---

## ✅ 요약
- Docker = 여러 프로그램을 안전하게 묶는 상자  
- Castopod = 팟캐스트 방송국  
- 자동화 = 유튜브 → 오디오 → RSS 발행  
- Dashboard = 비개발자용 제어판  
- 백업 = 데이터 안전망

---

## 📚 참고자료
- Castopod 공식 문서: [https://castopod.org/docs/](https://castopod.org/docs/)
- Docker 입문 강의: [https://docker-curriculum.com/](https://docker-curriculum.com/)
- yt-dlp: [https://github.com/yt-dlp/yt-dlp](https://github.com/yt-dlp/yt-dlp)
- ffmpeg: [https://ffmpeg.org/](https://ffmpeg.org/)
